<!DOCTYPE html>
<html>
    <head>
        <title>Main Experiment</title>
        <script src="https://unpkg.com/jspsych@7.3.4"></script>
        <script src="https://unpkg.com/@jspsych/plugin-survey-likert@1.1.3"></script>
        <script src="https://unpkg.com/@jspsych/plugin-html-keyboard-response@1.1.3"></script>
        <link href="https://unpkg.com/jspsych@7.3.4/css/jspsych.css" rel="stylesheet" type="text/css" />
    </head>
    <body></body>
    <script>
        // Initialize jsPsych
        var jsPsych = initJsPsych();
        var timeline = [];

        // Function to randomly select and redirect to the appropriate experiment
        function randomAllocation() {
            // 50% chance to load either gain or loss experiment
            if (Math.random() < 0.5) {
                window.location.href = "gain_exp.html";  // Redirect to gain experiment
            } else {
                window.location.href = "loss_exp.html";  // Redirect to loss experiment
            }
        }



        /* define welcome message trial */
        var welcome = {
            type: jsPsychHtmlKeyboardResponse,
            stimulus: "Welcome to the experiment. Press any key to begin."
        };
        timeline.push(welcome);
  
        /* define instructions trial */
        var instructions = {
            type: jsPsychHtmlKeyboardResponse,
            stimulus: `
                <p style="text-align: left;">In this experiment, you will read some texts and make decisions based on the contexts.</p>
                <p style="text-align: left;">You need to choose among 3 options: choice A, choice B, and choice C.</p>
                <p style="text-align: left;">If you choose <strong>option A</strong>, press <strong>letter A</strong> on the keyboard.</p>
                <p style="text-align: left;">If you choose <strong>option B</strong>, press <strong>letter B</strong> on the keyboard.</p>
                <p style="text-align: left;">If you choose <strong>option C</strong>, press <strong>letter C</strong> on the keyboard.</p>
                <p style="text-align: left;">Press any key to continue.</p>
            `,
        };
        timeline.push(instructions);
  

        // Add redirection after instruction
        timeline.push({
            type: jsPsychHtmlKeyboardResponse,
            stimulus: `
                <p style="text-align: left;">Now, we will start the experiment. </p>
                <p style="text-align: left;">Press any key to begin.</p>
            `,
            on_finish: function() {
                setTimeout(function() {
                    randomAllocation();  // Call the function to redirect to one of the tasks
                }, 2000);
            }
        });

        // Run the experiment
        jsPsych.run(timeline);
    </script>
</html>